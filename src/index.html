<html>
<head>
	<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
	<meta content="utf-8" http-equiv="encoding">	

	<title>OmniRadio</title>
	<link rel="stylesheet" href="css/main.css">

	<!-- Firebase -->
	<script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-auth.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-database.js"></script>

	<!-- JQuery Cookie -->
	<script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>

	<!-- Initialise Firebase -->
	<script src="scripts/Firebase/firebase-helpers.js"></script>
	<script src="scripts/Firebase/init-firebase.js"></script>
</head>
<header style="visibility: hidden;">
    <div class="now-playing-banner" id="now-playing-banner-object">
		<!-- Play button -->
		<div class="play-button" id="now-playing-banner-play-button"></div>
		<div class="vl"></div>
		<div class="sound-button"></div>

		<!-- Banner Text -->
        <p id="now-playing-banner-text"></p>

		<div style="position: relative; float: right;" id="now-playing-banner-rightmost-part">
			<div class="mic-onoff-icon"></div>

			<div class="vl" style="margin-top: 15px;"></div>
			
			<!-- User Login Dropdwon -->
			<div class="dropdown" id="login-dropdown">
				<div class="dropbtn" id="user-login-dropdown-back-button" onclick="toggle_dropdown_with_ID('login-dropdown');"></div>
	
				<div class="dropdown-content">
					<div id="login-box">
						<label for="login-form-uname">Username:</label><br>
						<input type="text" class="textbox" id="login-form-uname" name="login-form-uname"><br>
						<label for="login-form-passw">Password:</label><br>
						<input type="password" class="textbox" id="login-form-passw" name="login-form-passw"><br><br>
						<input type="submit" value="Sign In" onclick="sign_in(event);">
						<hr>
						<button>Sign Up</button>
					</div>
				</div>
	
				<script src="scripts/user-authentication.js"></script>
			</div>	
		</div>


		<!-- This is for the login dropdown -->
		<script>
			function toggle_dropdown_with_ID(id)
			{
				var dropdown = document.getElementById(id);
				var dropdown_content = dropdown.getElementsByClassName('dropdown-content')[0];

				var clicked = dropdown.getAttribute('clicked');
				if (clicked == 'yes')
				{
					dropdown.setAttribute('clicked', 'no');
					dropdown_content.style.display = 'none';
				}
				else
				{
					dropdown.setAttribute('clicked', 'yes');
					dropdown_content.style.display = 'block';
				}
			}

			function toggle_dropup_with_ID(id)
			{
				var dropdown = document.getElementById(id);
				var dropdown_content = dropdown.getElementsByClassName('dropup-content')[0];

				var clicked = dropdown.getAttribute('clicked');
				if (clicked == 'yes')
				{
					dropdown.setAttribute('clicked', 'no');
					dropdown_content.style.display = 'none';
				}
				else
				{
					dropdown.setAttribute('clicked', 'yes');
					dropdown_content.style.display = 'block';
				}
			}
		</script>
    </div>

	<br>

	<script src="scripts/page-load.js"></script>

	<!-- Initialisation -->
	<script src="scripts/index-initialisation.js"></script>
</header>
<body style="visibility: hidden;">

	<br>
	<br>

	<div class="intro" style="width: fit-content; margin: auto;">
		<h1>OmniRadio</h1>
	</div>

	<div class="nav-menu">
		<ul>
			<li><a href="./menu/news.html">News</a></li>
			<li><a href="./menu/contact.html">Contact</a></li>
			<li><a href="./menu/about.html">About</a></li>
		</ul>
	</div>

	<div class="intro">
		<h3>The all-in-one e-radio plaform for professionals and hobbyists</h3>
	</div>

	<div class="podcast-news-table-space" style="width: 25%;">
		<h4 class="podcast-news-table-title">Planned Podcasts</h4>
		<div style="overflow-y: scroll; max-height: 425px;">
			<table class="podcast-news-table">
				<tbody>
				</tbody>
			</table>
		</div>
	</div>


	<div style="display: flex;">

	</div>

	<div id="open-chatbox-button" class="dropup" onclick="toggle_dropup_with_ID('open-chatbox-button');">
		<img src="./img/chat.png">

		<div class="dropup-content">
			<!-- Chat space -->
			<div class="livechat" style="right: 0; width: 100%;">
				<div class="live-chat-container">
					<yt-live-chat-renderer>
						<yt-live-chat-item-list-renderer>
						</yt-live-chat-item-list-renderer>
					</yt-live-chat-renderer>
				</div>
				<input type="text" class="yt-live-chat-message-box" id="live-chat-message-box">
				<script src="scripts/livechat.js"></script>	
			</div>
		</div>
	</div>

	<script src="scripts/general.js"></script>

	<!-- Livechat -->
	<script src="scripts/streaming-client.js"></script>

	<!-- Scheduled Podcasts List -->
	<script>
		var podcast_table = document.getElementsByClassName('podcast-news-table')[0];

		function get_html(title, description, date)
		{
			const html =	"<td>"																					+
								"<div class='podcast-news-table-news-title'>" + title + "</div>"					+
								"<div class='podcast-news-table-news-columns-separator'>"							+
									"<div class='podcast-news-table-news-description'>" + description + "</div>"	+
									"<div class='podcast-news-table-news-date'>" + date + "</div>"					+
								"</div>"																			+
							"</td>";

			return html;
		}

		var title 		= 'error';
		var description = 'error';
		var date 		= 'no-date';
		var start_time 	= 'start-time';
		var end_time	= 'end-time';

		database.ref().child('/scheduled-podcasts').get().then((snapshot) => {
			if (snapshot.exists()) 
			{
				var i = 0;

				var json = snapshot.val();

				Object.keys(json).forEach(key => {
					var element = json[key];

					console.log('got element', element);

					title 		= element['title'];
					description = element['description'];
					date 		= element['date'];
					start_time 	= element['start_time'];
					stop_time 	= element['stop_time'];

					var row = podcast_table.insertRow(i++);
					row.innerHTML = get_html(title, description, date);
				});
			}
			else
			{
				// no data available; no podcasts scheduled for this week
				var row = podcast_table.insertRow(0);
				row.innerHTML = 'Sorry :( No podcasts scheduled for this week!';
			}
		}).catch((error) => {
  			console.error(error);
		});
	</script>

	<!-- Move banner -->
	<script src="scripts/move_banner.js"></script>
</body>
</html>