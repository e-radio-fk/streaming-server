<html>
	<head>
		<meta content="text/html;charset=utf-8" http-equiv="Content-Type" />
		<meta content="utf-8" http-equiv="encoding" />

		<title>OmniRadio</title>
		<link rel="stylesheet" href="css/main.css" />

		<!-- Firebase -->
		<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
		<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

		<!-- JQuery Cookie -->
		<script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>

		<!-- Initialise Firebase -->
		<script src="scripts/Firebase/firebase-helpers.js"></script>
		<script src="scripts/Firebase/init-firebase.js"></script>
	</head>
	<header style="visibility: hidden">
		<div class="now-playing-banner" id="now-playing-banner-object">
			<!-- Play button -->
			<div class="play-button" id="now-playing-banner-play-button"></div>
			<div class="vl"></div>
			<div class="sound-button"></div>

			<!-- Banner Text -->
			<p id="now-playing-banner-text"></p>

			<div
				style="position: relative; float: right"
				id="now-playing-banner-rightmost-part"
			>
				<div class="mic-onoff-icon"></div>

				<div class="vl" style="margin-top: 15px"></div>

				<!-- User Login Dropdwon -->
				<div class="dropdown" id="login-dropdown">
					<div
						class="dropbtn"
						id="user-login-dropdown-back-button"
						onclick="toggle_dropdown_with_ID('login-dropdown');"
					></div>

					<div
						class="dropdown-content"
						style="position: absolute; z-index: 1000 !important"
					>
						<!-- Login Box -->
						<div id="login-box">
							<label for="login-form-uname">Username:</label><br />
							<input
								type="text"
								class="textbox"
								id="login-form-uname"
								name="login-form-uname"
							/><br />
							<label for="login-form-passw">Κωδικός:</label><br />
							<input
								type="password"
								class="textbox"
								id="login-form-passw"
								name="login-form-passw"
							/><br /><br />
							<input
								type="submit"
								value="Είσοδος"
								style="display: flex; justify-content: center; padding-left: 0"
								onclick="sign_in(event);"
							/>
							<hr />
							<input
								type="submit"
								onclick="show_signup_box()"
								value="Εγγραφή"
							/>
						</div>

						<!-- SignUp Box -->
						<div id="signup-box" style="display: none">
							<img
								src="../img/back.png"
								width="25px"
								height="25px"
								onclick="show_login_box()"
							/>
							<br />

							<label for="signup-form-uname">Username:</label><br />
							<input
								type="text"
								class="textbox"
								id="signup-form-uname"
								name="signup-form-uname"
							/><br />
							<label for="signup-form-email">Email:</label><br />
							<input
								type="email"
								class="textbox"
								id="signup-form-email"
								name="signup-form-email"
							/><br />
							<label for="signup-form-passw">Κωδικός:</label><br />
							<input
								type="password"
								class="textbox"
								id="signup-form-passw"
								name="signup-form-passw"
							/><br />
							<div
								style="
									display: flex;
									flex-direction: row;
									align-items: center;
									gap: 2px;
								"
							>
								<label for="signup-form-isProducer">Παραγωγός</label>
								<input
									type="checkbox"
									id="signup-form-isProducer"
									name="signup-form-isProducer"
								/>
							</div>
							<hr />
							<button onclick="alert('here!')">Εγγραφή</button>
						</div>
					</div>

					<script>
						function show_signup_box() {
							document.getElementById("login-box").style.display = "none";
							document.getElementById("signup-box").style.display = "block";
						}
						function show_login_box() {
							document.getElementById("login-box").style.display = "block";
							document.getElementById("signup-box").style.display = "none";
						}
					</script>
					<script src="scripts/user-authentication.js"></script>
				</div>
			</div>

			<!-- This is for the login dropdown -->
			<script>
				function toggle_dropdown_with_ID(id) {
					var dropdown = document.getElementById(id);
					var dropdown_content =
						dropdown.getElementsByClassName("dropdown-content")[0];

					var clicked = dropdown.getAttribute("clicked");
					if (clicked == "yes") {
						dropdown.setAttribute("clicked", "no");
						dropdown_content.style.display = "none";
					} else {
						dropdown.setAttribute("clicked", "yes");
						dropdown_content.style.display = "block";
					}
				}

				function toggle_dropup_with_ID(id) {
					var dropup = document.getElementById(id);
					var dropup_content =
						dropup.getElementsByClassName("dropup-content")[0];

					var clicked = dropup.getAttribute("clicked");
					if (clicked == "yes") {
						dropup.setAttribute("clicked", "no");
						dropup.style.display = "none";
						dropup_content.style.display = "none";
					} else {
						dropup.setAttribute("clicked", "yes");
						dropup.style.display = "block";
						dropup_content.style.display = "block";
					}
				}
			</script>
		</div>

		<br />

		<script src="scripts/page-load.js"></script>

		<!-- Initialisation -->
		<script src="scripts/index-initialisation.js"></script>
	</header>

	<body style="visibility: hidden">
		<br />
		<br />

		<div class="intro">
			<h1>OmniRadio</h1>
		</div>

		<div class="nav-menu">
			<ul>
				<li><a href="./menu/news.html">Ειδήσεις</a></li>
				<li><a href="./menu/contact.html">Επικοινωνία</a></li>
				<li><a href="./menu/about.html">Περί του Site</a></li>
			</ul>
		</div>

		<div class="intro">
			<h3>
				Η all-in-one e-radio πλατφόρμα <br />
				για επαγγελματίες και χομπίστες
			</h3>
		</div>

		<div class="podcast-news-table-space" style="width: 25%">
			<h4 class="podcast-news-table-title">Προγραμματισμένα Podcasts</h4>
			<div style="overflow-y: scroll; max-height: 425px">
				<table class="podcast-news-table">
					<tbody></tbody>
				</table>
			</div>
		</div>

		<div style="display: flex"></div>

		<div
			id="open-chatbox-button"
			onclick="toggle_dropup_with_ID('chatbox-dropup');"
		>
			<img src="./img/chat.png" />
		</div>

		<div class="dropup" id="chatbox-dropup" style="right: 0">
			<div class="dropup-content" style="right: 5; bottom: -50; width: 300px">
				<!-- Chat space -->
				<div class="livechat" style="width: inherit">
					<div class="live-chat-container" style="width: inherit">
						<yt-live-chat-renderer>
							<yt-live-chat-item-list-renderer>
							</yt-live-chat-item-list-renderer>
						</yt-live-chat-renderer>
					</div>
					<input
						type="text"
						class="yt-live-chat-message-box"
						id="live-chat-message-box"
					/>
					<script src="scripts/livechat.js"></script>
				</div>
			</div>
		</div>

		<script src="scripts/general.js"></script>

		<!-- Livechat -->
		<script src="scripts/streaming-client.js"></script>

		<!-- Scheduled Podcasts List -->
		<script>
			var podcast_table =
				document.getElementsByClassName("podcast-news-table")[0];

			function get_html(title, description, date) {
				const html =
					"<td>" +
					"<div class='podcast-news-table-news-title'>" +
					title +
					"</div>" +
					"<div class='podcast-news-table-news-columns-separator'>" +
					"<div class='podcast-news-table-news-description'>" +
					description +
					"</div>" +
					"<div class='podcast-news-table-news-date'>" +
					date +
					"</div>" +
					"</div>" +
					"</td>";

				return html;
			}

			var title = "error";
			var description = "error";
			var date = "no-date";
			var start_time = "start-time";
			var end_time = "end-time";

			database
				.ref()
				.child("/scheduled-podcasts")
				.get()
				.then((snapshot) => {
					if (snapshot.exists()) {
						var i = 0;

						var json = snapshot.val();

						Object.keys(json).forEach((key) => {
							var element = json[key];

							console.log("got element", element);

							title = element["title"];
							description = element["description"];
							date = element["date"];
							start_time = element["start_time"];
							stop_time = element["stop_time"];

							var row = podcast_table.insertRow(i++);
							row.innerHTML = get_html(title, description, date);
						});
					} else {
						// no data available; no podcasts scheduled for this week
						var row = podcast_table.insertRow(0);
						row.innerHTML = "Sorry :( No podcasts scheduled for this week!";
					}
				})
				.catch((error) => {
					console.error(error);
				});
		</script>

		<!-- Move banner -->
		<script src="scripts/move_banner.js"></script>
	</body>
</html>
