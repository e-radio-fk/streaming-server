<html>
<head>
	<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
	<meta content="utf-8" http-equiv="encoding">

    <title>FK Live E-Radio: Console</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="bootstrap/css/bootstrap.css">

	<!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.1.2/firebase-database.js"></script>

	<!-- Initialise Firebase -->
    <script src="scripts/Firebase/firebase-helpers.js"></script>
	<script src="scripts/Firebase/init-firebase.js"></script>

    <!-- MCDatepicker -->
    <link href="https://cdn.jsdelivr.net/npm/mc-datepicker/dist/mc-calendar.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/mc-datepicker/dist/mc-calendar.min.js"></script>
</head>
<header>
    <div class="now-playing-banner" id="control-panel-nav-bar" style="position: relative;">
        <h4 style="position: absolute;" id="control-panel-nav-bar-title">Console&emsp;version 0.0.0.3</h4>
        <div class="dropdown" id="console-user-dropdown" onclick="toggle_dropdown_with_ID('console-user-dropdown');">
            <div class="dropdown-content">
              <a class="dropdown-content-button" href="./settings.html">Settings</a>
              <a class="dropdown-content-button" id="console-sign-out-button" onclick="sign_out()">Sign Out</a>
            </div>
            <img class="dropbtn" id="banner-user-img">
        </div>
    </div>

    <script defer src="scripts/user-authentication.js"></script>
    <script defer src="scripts/console-initialisation.js"></script>
</header>
<body>
    <!-- Start Podcast Dropdown -->
    <h3>Podcast</h3>

    <button data-toggle="modal" data-target="#schedule-podcast-modal">Plan Podcast</button>

    <!-- Schedule Podcast Modal -->
    <div class="modal fade" id="schedule-podcast-modal" tabindex="-1" role="dialog" aria-labelledby="schedule-podcast-modal-label" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
              <h4 class="modal-title" id="schedule-podcast-modal-label">Podcast Planner</h4>
            </div>
            <div class="modal-body">
                <!-- Date Picker disguised as a button -->
                <button id="podcast-datepicker">Pick a date</button>
                <p id="podcast-date-picked-label"></p>

                <div>
                    <!-- Time Picker -->
                    <div style="left: 10px; position: absolute;">
                        <label for="time">Έναρξη</label>
                        <input type="time" name="time" class="timepicker" id="podcast-start-time"/>
                    </div>
                    <div style="right: 10px; position: absolute;">
                        <label for="time">Λήξη</label>
                        <input type="time" name="time" class="timepicker" id="podcast-end-time"/>
                    </div>
                </div>

                <br>
                <br>

                <p>Θέμα</p>
                <textarea class="textbox" id="podcast-title" rows="1" style="width: 99%; resize: none;"></textarea>
                <p>Περιγραφή</p>
                <textarea class="textbox" id="podcast-description" rows="10" style="width: 99%; height: 300px;  resize: none;"></textarea>

                <br>
                <br>

                <!-- Add font awesome icons -->
                <a href="#" class="fa fa-facebook"></a>
                <a href="#" class="fa fa-instagram"></a>
            </div>
            <div class="modal-footer">
              <button type="button" onclick="schedule_new_podcast()">Καταχώρηση</button>
            </div>
          </div>
        </div>
    </div>

    <button class="dropdown" id="console-start-podcast-button" style="float: unset;" onclick="toggle_dropdown_with_ID('console-start-podcast-button')">
        start podcast
    
        <div class="dropdown-content" id="start-podcast-dropdown-content">
            <p class="dropdown-content-button" onclick="start_podcast(null)">... Just a random podcast</p>
            <!-- ... More entries must be filled here automatically from DB -->
        </div>
    </button>

    <script src="scripts/audio-visualisation.js"></script>

    <!-- Start Podcast Modal -->
    <div class="modal fade" id="start-podcast-modal" tabindex="-1" role="dialog" aria-labelledby="start-podcast-modal-label" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="schedule-podcast-modal-label">Έναρξη Podcast</h4>
            </div>
            <div class="modal-body">
                <p>Πρωτού ξεκινήσεις, έλεγξε το μικρόφωνο:</p>
                <div>
                    <button id="console-test-mic-button" style="display: inline-flex;" onclick="test_mic();">test mic</button>
                    <canvas id="console-microphone-visualisation" style="display: inline-flex;"></canvas>    
                </div>
            </div>
            <div class="modal-footer">
                <button id="console-start-podcast-after-soundcheck-button" onclick="start_podcast_after_soundcheck();">Εκκίνηση!</button>
            </div>
          </div>
        </div>
    </div>

    <h3>Playlists</h3>

    <button class="dropdown" id="import-playlist-button" onclick="toggle_dropdown_with_ID('import-playlist-button')"><i class="fa fa-download" style="padding: 0; margin: 0;"></i> import
        <div class="dropdown-content" id="start-podcast-dropdown-content">
            <p class="dropdown-content-button" onclick="import_playlist_from('yt')">From YT</p>
            <p class="dropdown-content-button" onclick="import_playlist_from('spotify')">From Spotify</p>
        </div>
    </button>

    <select name="playlists-selection" id="playlists-selection"></select>

    <!-- <div class="playlist-view">
        <div class="playlist-view-element"></div>
    </div> -->

    <!-- Import Playlist Modal -->
    <div class="modal fade" id="import-playlist-modal" tabindex="-1" role="dialog" aria-labelledby="import-playlist-modal-label" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <h4>Import from playlist</h4>
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="import-playlist-modal-label">Έναρξη Podcast</h4>
            </div>
            <div class="modal-body">
                 <textarea name="" id="" cols="30" rows="10"></textarea>
            </div>
            <div class="modal-footer">
                <button id="import-playlist-modal-ok-button" onclick=""></button>
            </div>
            </div>
        </div>
    </div>

    <div class="console-panels" id="console-panels-object" style="visibility: hidden;">
        <div class="console-panels-header">
            <h4 style="padding: 0; margin: 0;">Podcast Session (+ Title)</h4>
        </div>

        <div id="console-panels-bar">
            <button style="top: 0; bottom: 0; margin: 0;">Stop Session</button>
            <button style="top: 0; bottom: 0; margin: 0;" id="console-toggle-microphone">start mic</button>
            <!-- <p>Microphone <div id="microphone-visualisation"></div></p> -->
        </div>

        <div id="console-panels-view" style="display: block; display: flex;">
            <!-- Livechat -->
            <div class="livechat" style="visibility: visible;">
                <div class="live-chat-container" id="console-panels-livechat" style="left: 0; padding: 0; margin: 0; width: 100%">
                    <yt-live-chat-renderer>
                        <yt-live-chat-item-list-renderer>
                        </yt-live-chat-item-list-renderer>
                    </yt-live-chat-renderer>    
                </div>
                <input type="text" class="yt-live-chat-message-box" id="live-chat-message-box">    
                <script src="scripts/livechat.js"></script>
            </div>

            <!-- Current Playlist Songs View -->
            <div id="console-panel-playlist-view"></div>

            <!-- Controls View -->
            <div id="console-panel-controls">
                <!-- Music Section -->
                <div id="console-panel-controls-music-section">
                    <h3>Music Playback</h3>
                    <div id="console-panel-controls-music-subsection">
                        <div id="console-panel-controls-music-buttons">
                            <button id="music-button-backward" class="fa fa-backward"></button>
                            <button id="toggle-music-button" class="fa fa-play" onclick="toggle_music()"></button>
                            <button id="music-button-forward" class="fa fa-forward"></button>
                        </div>
                        <input type="range" id="console-panel-controls-music-volume-slider" value="20" oninput="change_volume(this.value)" onchange="change_volume(this.value)">        
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function toggle_dropdown_with_ID(id)
        {
            var dropdown = document.getElementById(id);
            var dropdown_content = dropdown.getElementsByClassName('dropdown-content')[0];

            var clicked = dropdown.getAttribute('clicked');
            if (clicked == 'yes')
            {
                dropdown.setAttribute('clicked', 'no');
                dropdown_content.style.display = 'none';
            }
            else
            {
                dropdown.setAttribute('clicked', 'yes');
                dropdown_content.style.display = 'block';
            }
        }
    </script>

    <!-- Scripts -->
    <!-- Note: this is mainly for darkmode -->
    <script src="scripts/darkmode.js"></script>
    <!-- general -->
    <script src="scripts/general.js"></script>
    <!-- socket.io -->
    <script src="https://cdn.socket.io/3.1.3/socket.io.min.js" integrity="sha384-cPwlPLvBTa3sKAgddT6krw0cJat7egBga3DJepJyrLl4Q9/5WLra3rrnMcyTyOnh" crossorigin="anonymous"></script>
    <script src="scripts/lib/socket.io-stream.js"></script>
    <!-- RecordRTC -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/RecordRTC/5.5.6/RecordRTC.js"></script>
    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
    <!-- Bootstrap -->
    <script src="bootstrap/js/bootstrap.min.js"></script>

    <!-- YT DL -->
    <script src="scripts/lib/ytdl.js"></script>
    <!-- Playlist Handler -->
    <script src="scripts/lib/playlistHandler.js"></script>

    <!-- Timepicker -->
    <script src="scripts/timepicker.js"></script>

    <!-- Console Functionality -->
    <script src="scripts/console-microphone.js"></script>
    <script src="scripts/console-playlist.js"></script>
    <script src="scripts/console-music.js"></script>
    <script src="scripts/console.js"></script>
</body>
</html>